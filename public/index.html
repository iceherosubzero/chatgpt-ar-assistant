<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>AR Car Showroom</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<!--script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/aframe-ar@1.8.0/dist/aframe-ar.min.js"></script-->

<!--script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script-->
<!--script src="https://cdn.jsdelivr.net/npm/aframe-ar@1.8.0/dist/aframe-ar.min.js"></script-->
  <!--script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script-->
  
  
  <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
<script type='text/javascript' src='https://raw.githack.com/AR-js-org/AR.js/3.4.7/aframe/build/aframe-ar.js'></script>
  
  <!--script src="https://cdn.jsdelivr.net/gh/chenzlabs/aframe-ar@master/dist/aframe-ar.min.js"></script-->
  <!--script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.min.js"></script-->
  <!--script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script-->

  
  
<style>
body, html { margin: 0; height: 100%; overflow: hidden; font-family: Arial, sans-serif; }
/*#ui { position: fixed; bottom: 12px; left: 50%; transform: translateX(-50%); width: 94%; max-width: 900px; display:flex; gap:8px; align-items:center; }*/
  #ui { position: fixed; bottom: 10px; width: 100%; display: flex; justify-content: center; gap: 8px; }
/*#prompt { width: 70%; padding: 8px; border-radius: 10px; border: 1px solid #ccc; font-size: 16px; }*/

#prompt { flex: 1; padding: 10px 12px; border-radius: 10px; border: 1px solid #ccc; font-size: 16px; }
#send, #talk { padding: 10px 14px; border-radius: 10px; border: none; background-color: #0084ff; color: white; font-size: 16px; cursor: pointer; }
#talk.listening { background-color: #ff5555; }
#status { position: fixed; top: 10px; left: 10px; background: rgba(0,0,0,0.4); color: #fff; padding:6px 10px; border-radius:8px; font-size:14px; }
</style>
</head>
<body>


<div id="status">AR Car Showroom</div>
  
<a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" renderer="antialias: true;" vr-mode-ui="enabled: false" xr-mode-ui="enabled: false" cursor="rayOrigin: mouse">
   
<!-- 3D Car model (place car_model.glb in public/) -->
<!--a-entity id="car" gltf-model="./car_model.glb" position="0 0 -2" scale="0.6 0.6 0.6"></a-entity-->

<!-- AI Orb assistant -->
<a-entity id="assistant" position="1 0 -2">
<a-sphere id="orb" color="#00ccff" radius="0.28" material="emissive:#00ccff; emissiveIntensity:0.5"></a-sphere>
<a-text id="reply" value="Ask me about this car!" position="-1 0.6 0" width="3.6" color="#fff"></a-text>
</a-entity>


<!-- Animated glowing hotspots -->
<a-entity id="wheel-hotspot" position="0.6 0 -2" geometry="primitive: sphere; radius: 0.12"
material="color:#ff9900; opacity:0.6; emissive:#ff9900; emissiveIntensity:0.8"
class="clickable" data-question="Tell me about the wheels of this car."
animation="property: scale; dir: alternate; dur: 1000; loop: true; to: 1.3 1.3 1.3"></a-entity>


<a-entity id="engine-hotspot" position="0 0.5 -2" geometry="primitive: sphere; radius: 0.12"
material="color:#33ccff; opacity:0.6; emissive:#33ccff; emissiveIntensity:0.8"
class="clickable" data-question="Can you explain the engine specifications?"
animation="property: scale; dir: alternate; dur: 1000; loop: true; to: 1.3 1.3 1.3"></a-entity>


<a-entity id="interior-hotspot" position="-0.6 0 -2" geometry="primitive: sphere; radius: 0.12"
material="color:#ff33cc; opacity:0.6; emissive:#ff33cc; emissiveIntensity:0.8"
class="clickable" data-question="What are the interior features of this car?"
animation="property: scale; dir: alternate; dur: 1000; loop: true; to: 1.3 1.3 1.3"></a-entity>


<a-camera position="0 0 0"></a-camera>
</a-scene>


<div id="ui">
<input id="prompt" placeholder="Ask about the car (or tap a hotspot)..." />
<button id="talk">ðŸŽ¤</button>
<button id="send">Send</button>
</div>

<script>
const orb = document.getElementById('orb');
const replyText = document.getElementById('reply');
const talkBtn = document.getElementById('talk');
const sendBtn = document.getElementById('send');
const promptInput = document.getElementById('prompt');
const status = document.getElementById('status');


function speak(text){
if(!text) return;
const u = new SpeechSynthesisUtterance(text);
u.lang = 'en-US';
u.rate = 1;
speechSynthesis.cancel();
speechSynthesis.speak(u);
}


function setStatus(s){ status.textContent = s; }


function updateOrbEmotionStructured(emotion){
let color = '#00ccff';
switch(emotion){
case 'happy': color='#00ff99'; break;
case 'excited': color='#ffcc00'; break;
case 'sad': color='#3366ff'; break;
case 'angry': color='#ff3333'; break;
case 'calm': color='#00cccc'; break;
case 'curious': color='#ff66ff'; break;
}
orb.setAttribute('color', color);
orb.setAttribute('material', `emissive:${color}; emissiveIntensity:0.85;`);
}


async function handleQuestion(question){
if(!question) return;
setStatus('Thinking...');
replyText.setAttribute('value','ðŸ¤” Thinking...');
try{
const res = await fetch('/api/chat',{ method:'POST', headers:{ 'Content-Type':'application/json' }, body: JSON.stringify({ prompt: question }) });
const data = await res.json();
const answer = data.answer || 'ðŸ¤– Sorry, I do not know.';
const emotion = data.emotion || 'curious';
replyText.setAttribute('value', answer);
speak(answer);
updateOrbEmotionStructured(emotion);
setStatus('AR Car Showroom');
}catch(err){
console.error('handleQuestion error', err);
replyText.setAttribute('value','ðŸ¤– Something went wrong.');
updateOrbEmotionStructured('sad');
setStatus('Error');
}
}


// Text send button
sendBtn.addEventListener('click', ()=>{ const q = promptInput.value.trim(); promptInput.value=''; handleQuestion(q); });


// Voice
const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
</html>




